class MoneyMask{static apply(e,t={}){document.querySelectorAll(e).forEach((e=>new MoneyMask(e,t)))}constructor(e,t={}){if("string"==typeof e)this.input=document.querySelector(e);else{if(!(e instanceof HTMLElement))return;this.input=e}this.input&&(this.options={decimal:",",thousands:".",precision:2,prefix:"â‚¬ ",allowNegative:!0,selectOnFocus:!1,...t},this.setupEventListeners())}setupEventListeners(){this.input.addEventListener("input",this.handleInput.bind(this)),this.input.addEventListener("focus",this.handleFocus.bind(this)),this.input.addEventListener("blur",this.handleBlur.bind(this)),this.input.addEventListener("keydown",this.handleKeyDown.bind(this))}handleInput(e){let t=e.target.value;const i=this.options.allowNegative&&t.includes("-");t=t.replace(/-/g,"");let s=this.extractNumericValue(t);i&&(s="-"+s);const a=this.formatValue(s);e.target.value=a}handleKeyDown(e){const{key:t,keyCode:i,ctrlKey:s,metaKey:a,shiftKey:n,target:o}=e;[46,8,9,27,13].includes(i)||"a"===t.toLowerCase()&&(s||a)||i>=35&&i<=40||("c"!==t.toLowerCase()&&"v"!==t.toLowerCase()&&"x"!==t.toLowerCase()||!s&&!a)&&("-"!==t&&189!==i?t!==this.options.decimal?(n||i<48||i>57)&&(i<96||i>105)&&e.preventDefault():o.value.includes(this.options.decimal)&&e.preventDefault():this.options.allowNegative&&!o.value.includes("-")||e.preventDefault())}extractNumericValue(e){const t=this.escapeRegex(this.options.decimal),i=new RegExp(`[^0-9${t}]`,"g");let s=e.replace(i,"");const a=s.split(this.options.decimal);return a.length>2&&(s=a[0]+this.options.decimal+a.slice(1).join("")),s}formatValue(e,t=!1){if(!e)return"";const i=this.options.allowNegative&&e.startsWith("-");let s=e.replace(/[^\d]/g,"");if(!s)return i?`${this.options.prefix}-`:"";let a=parseFloat(s)/Math.pow(10,this.options.precision);i&&(a=-a);const n=Math.abs(a).toFixed(this.options.precision).split(".");n[0]=n[0].replace(/\B(?=(\d{3})+(?!\d))/g,this.options.thousands);return`${this.options.prefix}${i?"-":""}${n.join(this.options.decimal)}`}handleFocus(e){if(this.options.selectOnFocus)e.target.select();else{const t=e.target.value.length;e.target.setSelectionRange(t,t)}}handleBlur(e){const t=e.target.value,i=this.options.allowNegative&&t.includes("-"),s=t.replace(/-/g,""),a=this.extractNumericValue(s);e.target.value=this.formatValue(i?"-"+a:a,!0)}getValue(){const e=this.input.value,t=this.options.allowNegative&&e.includes("-"),i=e.replace(/-/g,""),s=this.extractNumericValue(i);return t?-parseFloat(s.replace(this.options.decimal,".")):parseFloat(s.replace(this.options.decimal,"."))}setValue(e){const t=String(e),i=this.options.allowNegative&&t.startsWith("-"),s=t.replace(/-/g,"");this.input.value=this.formatValue(i?"-"+s:s)}escapeRegex(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}}